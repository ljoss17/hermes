[target.aarch64-unknown-linux-gnu]
pre-build = [
    "apt-get update -q",
    "DEBIAN_FRONTEND=noninteractive apt-get install -y --no-install-recommends apt-utils libssl-dev libsasl2-dev pkg-config",
    
    # Enable ARM64 architecture
    "dpkg --add-architecture arm64 && apt-get update -q",
    
    # Install system dependencies
    "apt-get install -y --no-install-recommends libssl-dev:arm64 unzip",

    # Add LLVM official repository
    "wget -O - https://apt.llvm.org/llvm.sh | bash",

    # Install latest available Clang (change version if needed)
    "apt-get install -y clang-16 lld-16 llvm-16",

    # Verify Clang installation
    "clang-16 --version",

    # Install Protoc manually
    "curl -LO https://github.com/protocolbuffers/protobuf/releases/download/v25.0/protoc-25.0-linux-x86_64.zip",
    "unzip protoc-25.0-linux-x86_64.zip -d /usr/local",
    "chmod +x /usr/local/bin/protoc",

    # Set environment variables
    "export PATH=\"/usr/local/bin:$PATH\"",
    "export CC=clang-16",
    "export CXX=clang++-16"
]
